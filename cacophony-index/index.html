<html><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">


    <style type="text/css">

        html {
            font-family: Roboto, "Segoe UI'", sans-serif;
        }

        #chart-wrapper {
            max-width: 1024px;
            height: 60vh;
            margin: 20px auto 0;
        }

        #chart {
            width: 100%;
            height: 100%;
        }

        h1 {
            font-weight: 300;
        }


        /*#chart div {
            font: 10px sans-serif;
            background-color: steelblue;
            text-align: right;
            padding: 3px;
            margin: 1px;
            color: white;
        }*/

    </style>

</head>

<body>

<div>
<div id="chart-wrapper">
    <h1>Cacophony Index</h1>
    <svg id="chart"></svg>
</div>


</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.15.0/d3.js"></script>
<script type="text/javascript" src="js/descriptive-stats.js"></script>
<script src="https://unpkg.com/popper.js@1"></script>
<script src="https://unpkg.com/tippy.js@5/dist/tippy-bundle.iife.js"></script>


<script>
    //var ctx = document.getElementById('myChart').getContext('2d');

    let data = [[1574270033, 50.8], [1574748351, 54.4], [1574368090, 57.2], [1575264171, 41.8], [1574229024, 65.2], [1574396911, 36.4], [1574193931, 57.8], [1574529723, 43.5], [1574196331, 43.8], [1574238074, 57.7], [1574508071, 54.4], [1574403531, 65.0], [1574695458, 68.7], [1574540528, 61.3], [1574282871, 55.3], [1574533323, 55.5], [1574478790, 35.7], [1574657811, 64.5], [1574140311, 68.3], [1574569671, 36.8], [1574806492, 36.1], [1574195110, 66.0], [1574328030, 46.5], [1574554350, 37.2], [1574372325, 39.2], [1574198751, 44.6], [1574688258, 54.4], [1574583630, 55.8], [1574626330, 54.6], [1574166193, 56.5], [1574346121, 50.3], [1574542891, 60.5], [1575261750, 38.2], [1574230852, 69.2], [1574511798, 51.0], [1574738430, 38.2], [1574542270, 54.4], [1574484451, 47.0], [1574587269, 54.6], [1574579831, 55.1], [1574640790, 38.2], [1574742331, 38.2], [1574544670, 41.1], [1574486851, 68.4], [1574723590, 41.4], [1574717631, 38.5], [1574483830, 40.2], [1574662871, 57.8], [1574547070, 54.0], [1574489251, 53.8], [1574162570, 55.6], [1574486230, 70.0], [1574402890, 56.8], [1574715310, 57.8], [1574283430, 61.1], [1574488630, 69.7], [1574324469, 57.2], [1575247272, 36.4], [1574575651, 62.9], [1574399332, 70.0], [1574540508, 59.7], [1574229765, 74.5], [1574731064, 35.3], [1574608577, 48.0], [1574372345, 38.5], [1574713990, 64.2], [1574455906, 44.4], [1574569651, 38.5], [1574228457, 67.9], [1574176902, 61.3], [1574727285, 33.0], [1574224210, 62.6], [1574656611, 39.2], [1574569244, 38.9], [1574558085, 49.4], [1574320850, 57.5], [1574142711, 63.2], [1575267730, 62.1], [1574741751, 37.2], [1574508052, 65.8], [1574317271, 65.6], [1574252476, 55.8], [1574234451, 57.2], [1574248875, 56.2], [1574575630, 63.7], [1574360486, 61.7], [1574187722, 60.1], [1574372890, 38.2], [1574454088, 62.5], [1574143411, 57.5], [1574594471, 53.8], [1574747731, 57.7], [1574590870, 41.8], [1574570830, 44.1], [1574385137, 31.4], [1574573350, 70.0], [1574801791, 54.2], [1574805271, 37.9], [1574388759, 37.5], [1574371731, 37.9], [1574328069, 49.6], [1574225465, 38.9], [1574374131, 37.2], [1574342519, 42.4], [1574252457, 63.8], [1574140270, 67.8], [1574454591, 58.3], [1574482851, 37.2], [1574173322, 55.5], [1574199910, 41.4], [1574570251, 37.9], [1574612157, 65.0], [1574137870, 38.5], [1575263571, 39.5], [1574122132, 32.6], [1574456991, 34.2], [1574744230, 63.6], [1574197510, 63.2], [1574342538, 50.5], [1575250911, 37.9], [1574792528, 47.3], [1574637150, 39.2], [1574569224, 41.1], [1574229744, 72.6], [1574335238, 52.6], [1574626971, 60.9], [1574360506, 62.9], [1574680834, 55.1], [1574459391, 39.2], [1574224810, 50.1], [1574196351, 50.8], [1574132996, 39.9], [1574396040, 36.4], [1574684434, 58.1], [1574460591, 35.7], [1574744731, 69.5], [1574738450, 36.1], [1574342476, 38.5], [1574302243, 36.8], [1574331650, 58.9], [1574713411, 62.6], [1574594432, 65.6], [1574432052, 61.5], [1574691877, 44.9], [1574200551, 36.8], [1574385118, 38.2], [1574138511, 33.8], [1574717011, 35.7], [1574397511, 42.1], [1574691838, 53.2], [1574745310, 70.4], [1574539891, 61.7], [1574143892, 58.8], [1574695477, 46.8], [1574576231, 57.3], [1574658370, 70.0], [1574583650, 58.0], [1574456350, 34.6], [1574212215, 40.2], [1574561664, 41.1], [1574541091, 60.4], [1574544691, 40.8], [1574788909, 55.1], [1574661970, 59.1], [1574561684, 39.2], [1574576252, 51.4], [1574453634, 64.5], [1574547091, 49.9], [1574688277, 56.0], [1574659570, 67.3], [1574335258, 45.2], [1574460111, 41.8], [1574305825, 37.5], [1574226051, 58.3], [1574195831, 58.9], [1574526083, 58.0], [1575290726, 46.5], [1574554369, 38.9], [1574403490, 46.5], [1574545270, 43.8], [1574456950, 38.5], [1575265951, 62.9], [1575247292, 39.2], [1574539870, 64.4], [1574425253, 65.0], [1574601213, 56.5], [1574629930, 38.5], [1574450013, 63.7], [1574398111, 37.2], [1574187683, 61.5], [1574366904, 59.7], [1574450052, 60.1], [1574658970, 70.4], [1574353285, 59.4], [1574201151, 36.8], [1574280505, 64.0], [1574631871, 37.5], [1574259213, 60.1], [1574226010, 65.4], [1574298524, 40.8], [1574774474, 59.1], [1574714590, 43.8], [1574255652, 58.1], [1574280546, 58.3], [1574632951, 37.5], [1574805891, 35.7], [1574262813, 59.7], [1574745331, 70.5], [1574804671, 35.7], [1574545291, 44.1], [1574493650, 57.3], [1574259252, 61.5], [1574458771, 36.4], [1574228498, 71.0], [1574369311, 58.9], [1574718811, 38.2], [1574488265, 61.6], [1574508032, 69.1], [1574143390, 53.0], [1574371711, 35.3], [1574455171, 46.8], [1575265930, 61.3], [1574425233, 60.8], [1574460091, 38.5], [1574715351, 48.7], [1574500850, 58.6], [1574718831, 35.7], [1574475151, 37.2], [1574718211, 36.1], [1574401731, 64.2], [1574273613, 57.5], [1574629330, 42.4], [1574656011, 38.9], [1574575071, 64.4], [1574715811, 39.5], [1574270052, 50.1], [1574373651, 38.5], [1575279750, 43.5], [1574442813, 55.5], [1574659611, 69.7], [1574273652, 44.4], [1574398831, 57.3], [1574716411, 28.7], [1574489852, 58.5], [1574590851, 52.6], [1574483230, 37.9], [1574259233, 59.7], [1575267171, 65.5], [1574129376, 55.6], [1574627671, 70.3], [1574310571, 35.7], [1574483872, 35.7], [1574742310, 38.2], [1574712831, 65.7], [1574536886, 62.2], [1574381499, 38.5], [1574346082, 50.1], [1574370532, 37.5], [1574558104, 46.8], [1574493630, 56.0], [1574747710, 57.7], [1574800450, 60.6], [1574162531, 56.5], [1574504451, 58.5], [1574368131, 53.4], [1574655191, 38.5], [1574565326, 39.2], [1574515253, 61.9], [1574280526, 56.7], [1574541790, 63.1], [1574774496, 66.5], [1574401090, 66.9], [1574312391, 66.9], [1574273633, 47.0], [1574180521, 62.1], [1574619857, 51.8], [1574364126, 56.5], [1574796110, 51.2], [1574731025, 56.5], [1575258110, 55.1], [1574659591, 70.6], [1574223631, 44.1], [1574353305, 54.4], [1574801071, 69.1], [1574572651, 67.9], [1574215835, 37.9], [1574734830, 39.2], [1574227231, 70.5], [1574666470, 58.5], [1574716990, 38.2], [1574432033, 65.1], [1574655671, 37.2], [1574320830, 56.5], [1574799850, 56.3], [1574743551, 35.7], [1574317251, 62.2], [1574311150, 36.8], [1574201131, 38.5], [1574806471, 38.5], [1574229045, 60.6], [1574785289, 58.1], [1574266413, 54.4], [1575267751, 61.6], [1574688238, 57.8], [1574377744, 37.9], [1575266551, 67.0], [1574284073, 40.2], [1574781703, 59.7], [1575250892, 47.5], [1574223652, 34.6], [1574493669, 62.2], [1574151709, 57.8], [1574714031, 51.6], [1574133015, 39.5], [1574369931, 64.1], [1574187703, 61.5], [1575287107, 67.1], [1574745352, 69.3], [1574374111, 35.0], [1574281051, 53.8], [1574212254, 39.5], [1574651610, 39.5], [1574629371, 38.5], [1574571430, 53.2], [1574421651, 56.2], [1574659011, 68.4], [1574457710, 38.5], [1574536925, 59.5], [1575265330, 69.9], [1574371251, 35.7], [1574139211, 35.0], [1574294943, 37.2], [1574195131, 65.0], [1574287030, 39.2], [1574475171, 37.9], [1574212235, 36.8], [1574262833, 60.2], [1574248836, 56.5], [1574544111, 38.9], [1574483271, 36.1], [1574460070, 43.2], [1574546511, 41.4], [1574316651, 65.6], [1574485671, 69.6], [1574744710, 67.6], [1574277265, 47.5], [1574799871, 58.5], [1574310071, 39.9], [1574802850, 41.4], [1574369290, 61.7], [1574284053, 40.5], [1574410830, 57.7], [1574315391, 64.5], [1574371690, 40.5], [1574631171, 35.7], [1574129396, 30.9], [1574228478, 69.6], [1574367728, 63.6], [1574629971, 42.1], [1574180482, 60.6], [1574651590, 40.2], [1574372911, 35.7], [1574486872, 68.3], [1574286430, 37.9], [1574313029, 70.8], [1574579870, 54.9], [1574143871, 67.1], [1574371230, 40.2], [1574541811, 64.5], [1574349705, 62.5], [1574162551, 61.7], [1574305805, 40.8], [1574570851, 35.7], [1574565346, 38.9], [1575261791, 40.8], [1574709838, 57.2], [1574515233, 65.6], [1574616030, 52.2], [1574339001, 59.5], [1574800471, 59.1], [1574748911, 60.8], [1574661025, 61.6], [1574803631, 36.8], [1574804050, 39.2], [1574191303, 66.8], [1574471573, 35.7], [1574400531, 70.9], [1574661406, 56.5], [1574284032, 39.5], [1574396931, 35.7], [1575247311, 33.0], [1574666451, 55.3], [1574482371, 35.7], [1574166213, 51.8], [1574342499, 42.7], [1574454571, 58.9], [1575268951, 52.0], [1574372304, 39.2], [1574801811, 55.1], [1574313049, 70.3], [1574657791, 61.1], [1575254491, 45.2], [1574142091, 65.4], [1574368731, 64.8], [1574148070, 57.5], [1574456971, 36.1], [1574723629, 36.8], [1574223015, 42.9], [1574141491, 65.2], [1574224831, 43.5], [1574511818, 53.0], [1574369911, 65.1], [1574637130, 42.7], [1574487471, 64.2], [1574626351, 59.7], [1574199931, 35.7], [1574195852, 59.9], [1574810085, 38.5], [1574399311, 69.0], [1574230278, 62.4], [1574238035, 61.1], [1575267771, 61.1], [1574680854, 55.6], [1574673632, 72.5], [1574197531, 66.0], [1574317230, 47.0], [1575276130, 75.9], [1574720011, 34.6], [1574169650, 59.8], [1574632330, 39.9], [1574558065, 49.9], [1575262930, 41.8], [1574284830, 40.8], [1574631130, 37.5], [1574446433, 48.7], [1574399890, 70.3], [1574455885, 49.4], [1574287051, 46.5], [1574587230, 67.8], [1574670031, 58.0], [1574144491, 48.0], [1574223054, 59.2], [1574285251, 37.2], [1574402434, 57.7], [1574241655, 55.1], [1574713431, 59.2], [1574198710, 42.1], [1574453676, 66.9], [1575268930, 60.2], [1574129415, 38.5], [1574385098, 37.9], [1574173303, 60.2], [1575261832, 30.9], [1574142670, 68.3], [1574287771, 36.8], [1574515303, 56.5], [1574193910, 58.8], [1575266571, 70.0], [1574196931, 59.7], [1574630551, 35.7], [1574734869, 38.2], [1574227810, 71.5], [1574572071, 66.4], [1574139231, 35.7], [1574543511, 46.8], [1574802250, 65.0], [1574604884, 60.4], [1574374090, 39.9], [1574400490, 70.1], [1574655211, 35.7], [1574545911, 41.1], [1574541070, 58.9], [1574370511, 36.8], [1574486271, 70.2], [1574270013, 52.0], [1574286451, 37.9], [1574543470, 42.1], [1574488671, 62.4], [1574744271, 65.8], [1574143431, 56.0], [1574485030, 64.3], [1574320869, 56.2], [1574648011, 39.9], [1574713390, 61.5], [1574487430, 64.1], [1574410869, 58.0], [1574680873, 52.8], [1574550670, 35.7], [1574464318, 36.4], [1574717590, 38.5], [1574311911, 36.8], [1574515272, 63.2], [1574281630, 47.8], [1574801091, 67.5], [1574407269, 48.9], [1574802871, 38.5], [1574684473, 59.8], [1574402931, 55.5], [1574314792, 64.1], [1574541111, 56.3], [1574230257, 56.0], [1574298504, 39.9], [1574432013, 69.8], [1574522503, 58.3], [1574215854, 39.2], [1574796090, 43.5], [1574252437, 62.4], [1574346102, 48.5], [1574137320, 35.7], [1574526122, 54.2], [1574313671, 69.4], [1574219454, 40.2], [1574799250, 57.0], [1574718190, 40.8], [1574439213, 56.8], [1574284871, 37.9], [1574324450, 44.6], [1574191322, 60.8], [1574714631, 44.4], [1574229065, 63.8], [1574533304, 56.5], [1574579851, 54.6], [1575264751, 63.7], [1574356906, 57.3], [1574718231, 35.7], [1574282252, 70.3], [1574316070, 57.5], [1574656031, 36.8], [1574575051, 64.5], [1574715831, 43.8], [1574184122, 57.7], [1574573851, 64.9], [1574471553, 39.2], [1574360525, 61.5], [1574227272, 69.0], [1574229785, 71.2], [1574454129, 61.6], [1574788928, 54.4], [1574219435, 37.2], [1574590831, 54.2], [1574799891, 59.8], [1574230831, 68.2], [1574367687, 64.2], [1574141470, 70.5], [1574373631, 39.2], [1574223035, 43.2], [1574778083, 58.3], [1574201110, 41.4], [1574428433, 64.9], [1574727304, 35.7], [1575262330, 36.1], [1575265351, 68.9], [1574561703, 36.4], [1574810104, 35.3], [1574529684, 57.0], [1574316631, 65.1], [1574139691, 33.4], [1574515342, 53.2], [1574196310, 58.1], [1574628752, 45.2], [1574660170, 63.5], [1574435633, 47.5], [1574311191, 33.4], [1574285833, 42.7], [1574661066, 59.4], [1574804650, 38.9], [1574283471, 44.1], [1574774516, 68.5], [1574623476, 56.2], [1574169630, 61.3], [1575276150, 61.7], [1574194531, 64.8], [1574281671, 49.6], [1574655651, 35.7], [1574140870, 69.2], [1574369890, 64.2], [1574428413, 64.0], [1575265971, 64.3], [1574688320, 54.0], [1574287071, 42.9], [1574587250, 53.6], [1575276169, 69.7], [1574335277, 57.3], [1574144511, 56.0], [1574632971, 36.1], [1574285271, 37.5], [1574367708, 62.1], [1574714611, 41.8], [1574623437, 55.3], [1575283350, 42.4], [1574142111, 65.7], [1574339040, 56.2], [1574196910, 59.7], [1574554330, 41.1], [1574314391, 70.0], [1574628171, 42.9], [1574569630, 37.9], [1574234431, 64.6], [1574392420, 38.5], [1574309425, 37.2], [1574631850, 38.5], [1574196951, 66.1], [1574407230, 40.8], [1574158970, 61.2], [1574224251, 51.2], [1574543491, 46.2], [1574500869, 62.5], [1574483851, 34.2], [1574396482, 37.2], [1574742351, 37.5], [1574545891, 38.5], [1574598110, 47.8], [1574542870, 62.9], [1574709858, 53.0], [1575254471, 42.4], [1574453715, 58.3], [1574785309, 64.0], [1574800491, 57.7], [1574802271, 58.5], [1574488651, 66.1], [1574485630, 69.1], [1574632371, 38.5], [1574655230, 37.5], [1574746531, 64.9], [1574805850, 42.7], [1574545870, 44.9], [1574702658, 61.5], [1575287126, 66.2], [1574661426, 55.6], [1574191283, 71.9], [1574478751, 36.4], [1574601233, 60.1], [1574648030, 38.5], [1574225445, 43.8], [1574392440, 37.2], [1574673671, 50.8], [1574294924, 36.8], [1574410850, 57.2], [1574629351, 38.5], [1574522483, 58.3], [1574658391, 70.2], [1574628151, 50.1], [1574184083, 56.0], [1574471592, 35.0], [1574803611, 43.2], [1574706238, 44.6], [1574398851, 58.9], [1574731045, 42.7], [1574137340, 39.5], [1574536906, 60.8], [1574353324, 54.7], [1574284851, 36.1], [1574368111, 43.5], [1574458191, 36.8], [1574399290, 70.3], [1574277304, 49.2], [1574796129, 53.0], [1574774435, 55.6], [1574497250, 56.3], [1574401690, 66.3], [1574699038, 67.0], [1574489831, 63.1], [1574482871, 36.8], [1574310051, 37.5], [1574747751, 46.5], [1574398090, 39.5], [1574446413, 40.2], [1574132976, 36.1], [1574661046, 60.4], [1574315371, 60.1], [1574657211, 41.1], [1574628793, 40.2], [1574155271, 54.6], [1575262951, 32.2], [1574482830, 38.2], [1574718790, 38.5], [1574632930, 42.4], [1574467972, 37.5], [1574198151, 33.0], [1574716390, 32.6], [1574439252, 54.4], [1574745910, 67.9], [1574633551, 37.2], [1575264730, 65.5], [1574719990, 44.1], [1574435652, 47.0], [1574195872, 56.7], [1574569312, 37.5], [1574138470, 37.9], [1574356886, 64.4], [1574446452, 56.7], [1575265371, 66.1], [1574368711, 64.4], [1574291390, 41.8], [1574616069, 50.3], [1574283451, 44.9], [1574497230, 57.0], [1574194510, 62.9], [1574373610, 38.9], [1575261730, 42.9], [1574245236, 57.8], [1574234470, 64.6], [1574418031, 54.6], [1574281651, 45.5], [1574458171, 37.9], [1574158931, 54.2], [1574583669, 51.0], [1574684454, 64.9], [1574781683, 55.6], [1574151690, 60.1], [1574331630, 57.2], [1574194551, 64.6], [1574657191, 41.8], [1574744751, 69.9], [1574719390, 39.5], [1575261769, 36.1], [1574310030, 36.8], [1574802891, 42.4], [1574627650, 69.1], [1574402911, 59.2], [1574573391, 68.8], [1574623457, 61.7], [1574717031, 39.9], [1574677254, 54.7], [1574281071, 50.3], [1574199951, 27.8], [1575268372, 50.5], [1574315350, 61.7], [1574688339, 55.5], [1574574471, 61.9], [1574482390, 31.4], [1575258071, 60.6], [1574291371, 40.8], [1574195151, 55.6], [1574227851, 70.3], [1574314771, 64.6], [1574651629, 37.5], [1574550690, 41.1], [1574544091, 46.0], [1574745931, 65.7], [1574483251, 35.7], [1574180502, 63.4], [1574774535, 54.0], [1574546491, 47.0], [1574457730, 39.2], [1574788889, 59.1], [1574324430, 54.6], [1574316091, 59.5], [1574277285, 44.9], [1574310591, 39.2], [1574364107, 58.6], [1574716431, 37.5], [1574485051, 65.1], [1574644429, 43.2], [1574706277, 44.6], [1574226618, 69.5], [1574673652, 48.7], [1574720031, 35.7], [1574208552, 46.8], [1574598091, 47.5], [1574575030, 63.5], [1574139711, 33.0], [1574709877, 54.9], [1575264151, 41.4], [1574227252, 67.0], [1574453696, 65.5], [1574397531, 36.1], [1574691858, 44.9], [1574518921, 59.2], [1574570230, 36.4], [1574224231, 43.5], [1574199431, 36.8], [1574285230, 42.4], [1574504470, 55.8], [1575290707, 63.1], [1574748952, 65.4], [1574204731, 36.1], [1574804091, 37.5], [1575267130, 64.6], [1574712790, 55.1], [1574442852, 58.3], [1574227831, 71.6], [1574702677, 68.5], [1574573371, 69.6], [1574628773, 43.8], [1574805291, 29.6], [1574612177, 49.6], [1574208591, 39.2], [1574142691, 66.4], [1574575671, 59.2], [1575272530, 56.2], [1574574451, 60.1], [1574137911, 32.2], [1574302224, 36.4], [1574677234, 52.2], [1574255613, 46.2], [1574604864, 61.6], [1574125705, 40.8], [1574349685, 60.4], [1574748310, 56.8], [1574298543, 38.5], [1574458791, 32.6], [1575264130, 43.2], [1574313008, 69.9], [1574226639, 70.4], [1574435613, 56.5], [1574647991, 37.9], [1574677273, 56.7], [1574197551, 69.6], [1574806450, 43.2], [1574241674, 56.5], [1574655990, 39.9], [1574511837, 55.3], [1574223672, 48.7], [1574241635, 60.2], [1574743051, 35.7], [1574377725, 35.7], [1574286471, 37.2], [1574598071, 48.0], [1574464298, 40.8], [1574748932, 59.5], [1574574430, 61.1], [1574804071, 38.5], [1574454550, 59.5], [1575262971, 42.9], [1574460571, 38.2], [1574309405, 37.9], [1574661991, 52.6], [1574316610, 61.6], [1574173283, 58.8], [1574550709, 40.8], [1574331669, 61.6], [1574633571, 36.8], [1575268971, 52.6], [1574576272, 58.3], [1574666431, 54.4], [1574245256, 60.8], [1574627691, 70.0], [1574282830, 48.7], [1574455926, 40.2], [1574281030, 67.6], [1574141511, 62.6], [1574248856, 53.0], [1574458150, 40.8], [1574226659, 69.4], [1574460550, 40.8], [1574569263, 37.2], [1574238055, 59.7], [1574802291, 61.7], [1575262371, 40.8], [1575263530, 50.3], [1574193951, 62.6], [1574312371, 65.3], [1574342437, 57.0], [1574619876, 49.2], [1574748331, 55.3], [1575272550, 53.4], [1574305844, 37.5], [1574314350, 67.4], [1574631891, 38.2], [1574658411, 71.0], [1574803590, 43.5], [1574660191, 58.6], [1574403511, 56.3], [1574743030, 39.5], [1574640810, 36.8], [1574287791, 36.1], [1574662011, 52.6], [1574631151, 37.2], [1574392459, 36.8], [1574399911, 68.6], [1574629951, 38.9], [1574475190, 35.7], [1574540487, 56.5], [1574644410, 40.2], [1574741710, 39.9], [1574467991, 33.0], [1574670051, 54.7], [1574148109, 53.8], [1574778103, 55.8], [1574526103, 59.4], [1574366945, 54.7], [1575263551, 42.9], [1574456391, 33.4], [1574397490, 36.1], [1574285854, 58.5], [1574486251, 69.9], [1574396020, 39.9], [1574136618, 31.4], [1574176921, 58.8], [1574140911, 70.5], [1574616050, 51.4], [1574699058, 55.1], [1574738469, 35.7], [1574717611, 33.0], [1574342457, 54.6], [1574662851, 56.8], [1574401131, 68.3], [1574504431, 58.0], [1575279730, 54.9], [1574799291, 54.9], [1574688300, 48.9], [1574370490, 36.8], [1574311171, 37.9], [1574396462, 33.8], [1574225424, 47.0], [1574208572, 35.7], [1574792509, 56.2], [1574312350, 62.2], [1574388798, 39.9], [1574314750, 63.8], [1575262351, 36.4], [1574396441, 36.4], [1574714011, 60.5], [1574633530, 43.5], [1574140891, 70.4], [1574143912, 60.5], [1574314371, 70.0], [1574399931, 67.4], [1574570871, 39.5], [1574200531, 37.2], [1574285874, 37.5], [1574139190, 36.1], [1574407250, 49.9], [1574626951, 60.4], [1574644390, 39.2], [1574459350, 39.2], [1574727265, 44.1], [1574539911, 57.3], [1574402475, 62.9], [1574637169, 37.5], [1574371271, 38.9], [1574542311, 46.5], [1574741731, 35.7], [1574544711, 42.7], [1574656570, 37.5], [1574414450, 55.1], [1574125725, 37.2], [1574368690, 63.1], [1574485071, 65.7], [1574706258, 40.2], [1574547111, 45.5], [1574456371, 37.9], [1574439233, 58.0], [1574799271, 52.0], [1575272569, 53.8], [1575264772, 65.1], [1574230298, 65.7], [1574702638, 66.3], [1574488224, 58.6], [1574266452, 47.3], [1574176882, 61.2], [1574428452, 58.3], [1574658991, 67.7], [1574746551, 63.7], [1574198731, 38.2], [1574366925, 57.5], [1574604903, 63.4], [1574695438, 64.6], [1574630530, 41.4], [1574215815, 40.2], [1574372931, 39.5], [1574478771, 36.4], [1574328050, 48.0], [1574569332, 38.5], [1574219415, 41.1], [1574571471, 54.0], [1574542291, 45.5], [1574570271, 38.5], [1574565365, 38.9], [1574282272, 66.7], [1574488245, 61.1], [1574287750, 37.2], [1574747230, 59.7], [1574489872, 55.5], [1574169669, 60.2], [1574464337, 35.7], [1574364087, 56.0], [1574747271, 55.6], [1574245275, 63.4], [1574529704, 49.4], [1574774455, 51.0], [1574122113, 37.2], [1574418070, 59.5], [1574155291, 47.5], [1575268351, 51.8], [1574339021, 56.7], [1574398810, 56.3], [1574522522, 60.6], [1574136579, 38.5], [1574450033, 65.6], [1574572030, 66.7], [1574569291, 39.9], [1574594452, 57.5], [1574421631, 58.5], [1575254510, 49.9], [1574204750, 39.9], [1574421670, 54.7], [1574715790, 55.8], [1575267151, 58.1], [1574396890, 40.2], [1574785328, 48.5], [1574640829, 38.5], [1575268330, 64.6], [1574151670, 58.0], [1574571451, 51.8], [1574425272, 65.2], [1574453654, 59.9], [1574230872, 56.3], [1574309444, 36.1], [1574518902, 61.7], [1574670070, 60.9], [1574781722, 45.2], [1574138491, 37.5], [1574747251, 61.6], [1574198131, 36.4], [1574533284, 54.7], [1574144470, 57.3], [1574662830, 59.4], [1574573830, 65.4], [1574810065, 38.5], [1574500830, 56.8], [1574125744, 33.0], [1574572630, 70.3], [1575279769, 40.2], [1574497269, 65.1], [1574801050, 65.3], [1574805871, 36.1], [1574200510, 36.8], [1574487451, 63.4], [1574302204, 41.1], [1574282851, 44.1], [1574655630, 39.2], [1574140291, 67.4], [1574122093, 37.5], [1574804691, 36.4], [1574388779, 35.7], [1574608557, 61.2], [1574184103, 58.5], [1574572051, 66.0], [1574401111, 66.9], [1574542911, 65.4], [1574316111, 56.7], [1574630571, 38.2], [1574459371, 37.2], [1574745951, 67.0], [1574545311, 36.8], [1574484471, 38.2], [1574148090, 56.2], [1574544070, 41.4], [1574612196, 58.9], [1574489271, 54.9], [1574656591, 37.5], [1574715331, 53.6], [1574484430, 41.1], [1574349724, 52.6], [1574546470, 39.2], [1574744251, 63.6], [1575250872, 39.5], [1574486830, 70.4], [1574608596, 55.6], [1574311891, 35.7], [1574457689, 41.4], [1574482351, 40.5], [1574489230, 54.4], [1574660211, 57.5], [1574453613, 55.8], [1574401711, 61.3], [1574467952, 38.5], [1574166232, 53.2], [1575290687, 42.4], [1574619837, 54.6], [1575287087, 60.6], [1574661385, 64.4], [1574137299, 41.4], [1574743510, 40.2], [1574199452, 39.2], [1574712811, 60.4], [1574381538, 37.5], [1574313651, 70.0], [1574204711, 53.4], [1574626371, 64.0], [1574224852, 40.8], [1574601252, 58.8], [1574719411, 39.9], [1574657770, 62.5], [1574294904, 37.2], [1574158951, 67.4], [1574801770, 57.2], [1574262852, 56.7], [1574805250, 40.8], [1574442833, 56.5], [1575261812, 36.8], [1574310550, 43.8], [1574743071, 38.2], [1574377705, 39.5], [1574136599, 35.7], [1574226031, 59.1], [1575283330, 43.5], [1574418051, 59.5], [1574458750, 40.2], [1574632351, 38.2], [1574746510, 64.2], [1574311870, 41.1], [1574628130, 52.2], [1574573871, 65.6], [1574137891, 36.1], [1574626930, 56.8], [1574398131, 37.2], [1574455150, 55.1], [1574572671, 67.6], [1574485651, 69.6], [1574255633, 47.5], [1574455191, 53.8], [1575258091, 50.3], [1574657170, 42.7], [1574356925, 50.1], [1574199472, 39.2], [1574515323, 52.2], [1574402455, 57.5], [1574142070, 67.8], [1574155310, 48.2], [1574291351, 59.8], [1574139670, 39.9], [1574699077, 65.3], [1574743531, 35.3], [1574414430, 68.4], [1574723610, 38.2], [1574198110, 38.2], [1574381519, 35.7], [1574396059, 35.7], [1574313630, 69.9], [1574454109, 65.1], [1574734850, 37.2], [1574541831, 65.6], [1574414469, 61.5], [1574369331, 54.4], [1574266433, 56.2], [1574792489, 47.3], [1575266530, 66.3], [1575283369, 52.8], [1574518882, 64.6], [1574778122, 46.5], [1574282231, 69.8], [1574400511, 70.3], [1574719431, 37.9]];

    let dataArrangedByHour = {};

    let timezoneOffset = new Date().getTimezoneOffset() * 60; // get timezone offset in minutes, convert to seconds

    for (let i = 0; i < data.length; i++) {

      let recordingDateUnixTimestamp = data[i][0];
      let recordingDateAdjustedForTimezone = recordingDateUnixTimestamp + timezoneOffset;

      let recordingDate = new Date(recordingDateAdjustedForTimezone * 1000); // multiply by 1000 to get milliseconds

      let recordingHour = recordingDate.getHours();
      let recordingIndex = data[i][1];

      if (!dataArrangedByHour.hasOwnProperty(recordingHour)) {
        dataArrangedByHour[recordingHour] = [];
      }

      dataArrangedByHour[recordingHour].push(recordingIndex);

    }


    let recordingsSummaryPerHour = [];

    Object.entries(dataArrangedByHour).forEach(function ([hour, indexes]) {
      recordingsSummaryPerHour[hour] = hour;
      recordingsSummaryPerHour[hour] = {
        'min': Math.min(...indexes),
        'q25': q25([...indexes]),
        'median': median([...indexes]),
        'q75': q75([...indexes]),
        'max': Math.max(...indexes)
      }
    });



    document.addEventListener('DOMContentLoaded', function () {

        /* Draw the chart */

        function drawChart() {
            let chartWrapperEl = document.getElementById("chart-wrapper");

            d3.selectAll('#chart g').remove(); // clear the previous chart if any; we need to do this to redraw a new chart on resize

            let yAxisWidth = 20;
            let xAxisHeight = 20;

            // see https://bl.ocks.org/mbostock/3019563
            let chartMargin = {top: 10, right: 20, bottom: xAxisHeight, left: yAxisWidth};

            // get the chart dimensions (set with CSS but relative to the size of the page); subtract the chart margins
            let chartWidth = chartWrapperEl.offsetWidth - chartMargin.left - chartMargin.right;
            let chartHeight = chartWrapperEl.offsetHeight - chartMargin.top - chartMargin.bottom;

            let barWidth = chartWidth / recordingsSummaryPerHour.length; // get the width of the chart, subtract axis, divide by length of the data

            let barPadding = Math.round(barWidth * 0.2); // add spacing between bars, make it proportional to bar width

            // scale our chart based on the data; this is a function (but it looks like a variable...). The domain is the "dimensions" of the data, the range is "dimensions" we mapping the data to - in this case our page size

            let chartYScale = d3.scaleLinear()
                .domain([20, 80]) // our domain is 0-100, the range of the cacophony index, but we'll only display values between 20 and 80
                .clamp(true) // make sure values out of bounds are not displayed
                .range([0, chartHeight]);

            let medianXScale = d3.scaleLinear() // maybe we can use the x axis scale if the data know about dates?
                .domain([0, 24]) // 24 hours
                .range([0, chartWidth]);

            // scales for y and x axes
            let yAxisScale = d3.scaleLinear()
                .domain([20, 80]) // 100 is max value for Cacophony index
                .range([chartHeight, 0]);

            let xAxisScale = d3.scaleTime() // maybe it should be scaleTime but opens other cans of worms
                //.domain([0, 24]) // 24 hours
                .range([0, chartWidth]);


            // Get chart element and create chart elements

            let chart = d3.select("#chart")
                .attr("width", chartWidth + chartMargin.left + chartMargin.right)
                .attr("height", chartHeight + chartMargin.top + chartMargin.bottom)
                .append("g")
                .attr("transform", "translate(" + chartMargin.left + "," + chartMargin.top + ")");

            let dataMinMax = chart.append('g')
                .attr('class', 'min-max');

            let dataQ25Q75 = chart.append('g')
                .attr('class', 'q25-q75');

            let dataMedian = chart.append('g')
                .attr('class', 'median');

            let dataHover = chart.append("g")
                .attr('class', 'hover-info');


            // Add bars for the min-max values
            dataMinMax.selectAll("rect") // although it says select all, it is actually creating the rectangle elements
                .data(recordingsSummaryPerHour) // pass the data to the chart
                .enter() // operate on the data, loop through it
                .append("rect") // add a rectangle element to the chart
                // because we're dealing with SVG, we need to set the right attributes to set the dimensions of the items; d is a magical entity that represents the item that is being iterated from our data
                .attr("y", function (d) { // set the y position (0,0 is at the top left corner of the chart)
                    return chartHeight - chartYScale(d['max']); // scale the data based on the dimensions of the chart
                })
                .attr("height", function (d) { // calculate the height of the bars
                    let minX = chartHeight - chartYScale(d['min']);
                    let maxX = chartHeight - chartYScale(d['max']);
                    return Math.abs(maxX - minX);
                })
                .attr("width", barWidth - barPadding * 2)
                // magic to position the bars one after the oder
                .attr("transform", function (d, i) {
                    return `translate(${[barWidth * i + barPadding, 0]})`; // first param is x, second is y
                })
                .style("fill", function (d) {
                    return "rgba(109, 189, 75, 0.2)";
                });

            // Add bars for q1-q3 values
            dataQ25Q75.selectAll("rect")
                .data(recordingsSummaryPerHour)
                .enter()
                .append("rect")
                .attr("y", function (d) {
                    return chartHeight - chartYScale(d['q75']);
                })
                .attr("height", function (d) {
                    let minX = chartHeight - chartYScale(d['q25']);
                    let maxX = chartHeight - chartYScale(d['q75']);
                    return Math.abs(maxX - minX);
                })
                .attr("width", barWidth - barPadding * 2)
                .attr("transform", function (d, i) {
                    return `translate(${[barWidth * i + barPadding, 0]})`;
                })
                .style("fill", function (d) {
                    return "rgba(109, 189, 75, 0.25)";
                });

            // Add the median line
            dataMedian.append("path")
                .datum(recordingsSummaryPerHour)
                .attr("transform", `translate(${barWidth / 2}, 0)`)
                .attr("fill", "none")
                .attr("stroke", "#2D8067")
                .attr("stroke-width", 5)
                .attr("d", d3.line()
                    .curve(d3.curveMonotoneX) // make our line curvy
                    .x(function (d, i) {
                        return medianXScale(i)
                    })
                    .y(function (d) {
                        return yAxisScale(d['median'])
                    })
                );

            // Add bars for the min-max values
            dataHover.selectAll("rect")
                .data(recordingsSummaryPerHour)
                .enter()
                .append("rect")
                .attr("y", 0)
                .attr("height", chartHeight)
                .attr("width", barWidth)
                .attr("transform", function (d, i) {
                    return `translate(${[barWidth * i, 0]})`;
                })
                .style("fill", "rgba(0, 0, 0, 0.05)")
                .style("opacity", 0)
                .style("transition", "0.2s linear")
                .on("mouseover", function (d, i) {
                    //console.log(d);
                    //console.log(d3.event);
                    d3.select(this)
                        .style("opacity", 1);

                    // TODO: this is just a POC.
                    // also: we might be able to get the info about the hours from the axis info instead of using the iterator

                    function formatHours(hour) {
                        if (hour === 0) {
                            return `12am`
                        } else if (hour < 12) {
                            return `${hour}am`
                        } else {
                            if ((hour-12) !== 0) {
                                return `${hour - 12}pm`
                            } else {
                                return `12pm`
                            }
                        }
                    }

                    tippy(d3.event.target, {
                        placement: "right",
                        content:
                            `<span>${formatHours(i)} - ${formatHours(i + 1)}</span>
                            <h1>${Math.round(d.median)}</h1>`
                    });

                })
                .on("mouseout", function (d) {
                    d3.select(this)
                        .style("opacity", 0)
                    /* div.transition()
                     .duration(500)
                     .style("opacity", 0);*/
                });


            /* Create the axes */

            let xAxisLabels = ["Midnight", "Midday", "Midnight"];


            let xAxisGenerator = d3.axisBottom()
                .scale(xAxisScale)
                .ticks(2) // minus one, apparently
                .tickFormat((d,i) => xAxisLabels[i]);

            let yAxisGenerator = d3.axisLeft()
                .scale(yAxisScale)
                .ticks(5)
                .tickSize(-chartWidth);


            let yAxis = chart.append("g")
                .attr('class', 'x-axis')
                .attr("transform", `translate(0, 0)`)
                .call(yAxisGenerator);

            let xAxis = chart.append("g")
                .attr('class', 'y-axis')
                .attr("transform", `translate(0, ${chartHeight})`)
                .call(xAxisGenerator);


            yAxis.select(".domain").remove();

            xAxis.select(".domain").remove();
            xAxis.selectAll(".tick line").remove();

            yAxis.selectAll(".tick line")
                .attr("opacity", "0.05");

            yAxis.selectAll(".tick text")
                .attr("fill", "#808080");

            xAxis.selectAll(".tick text")
                .attr("fill", "#808080");

        }

        drawChart();

        window.addEventListener("resize", drawChart);

    });


</script>





</body></html>